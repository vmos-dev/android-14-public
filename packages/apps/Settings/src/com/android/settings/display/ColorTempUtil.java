/*
 * Copyright (C) 2023 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.android.settings.display;

public class ColorTempUtil {

    private static double blackbody_color[] = {
            1.00000000, 0.18172716, 0.00000000, /* 1000K */
            1.00000000, 0.25503671, 0.00000000, /* 1100K */
            1.00000000, 0.30942099, 0.00000000, /* 1200K */
            1.00000000, 0.35357379, 0.00000000, /* ...   */
            1.00000000, 0.39091524, 0.00000000,
            1.00000000, 0.42322816, 0.00000000,
            1.00000000, 0.45159884, 0.00000000,
            1.00000000, 0.47675916, 0.00000000,
            1.00000000, 0.49923747, 0.00000000,
            1.00000000, 0.51943421, 0.00000000,
            1.00000000, 0.54360078, 0.08679949,
            1.00000000, 0.56618736, 0.14065513,
            1.00000000, 0.58734976, 0.18362641,
            1.00000000, 0.60724493, 0.22137978,
            1.00000000, 0.62600248, 0.25591950,
            1.00000000, 0.64373109, 0.28819679,
            1.00000000, 0.66052319, 0.31873863,
            1.00000000, 0.67645822, 0.34786758,
            1.00000000, 0.69160518, 0.37579588,
            1.00000000, 0.70602449, 0.40267128,
            1.00000000, 0.71976951, 0.42860152,
            1.00000000, 0.73288760, 0.45366838,
            1.00000000, 0.74542112, 0.47793608,
            1.00000000, 0.75740814, 0.50145662,
            1.00000000, 0.76888303, 0.52427322,
            1.00000000, 0.77987699, 0.54642268,
            1.00000000, 0.79041843, 0.56793692,
            1.00000000, 0.80053332, 0.58884417,
            1.00000000, 0.81024551, 0.60916971,
            1.00000000, 0.81957693, 0.62893653,
            1.00000000, 0.82854786, 0.64816570,
            1.00000000, 0.83717703, 0.66687674,
            1.00000000, 0.84548188, 0.68508786,
            1.00000000, 0.85347859, 0.70281616,
            1.00000000, 0.86118227, 0.72007777,
            1.00000000, 0.86860704, 0.73688797,
            1.00000000, 0.87576611, 0.75326132,
            1.00000000, 0.88267187, 0.76921169,
            1.00000000, 0.88933596, 0.78475236,
            1.00000000, 0.89576933, 0.79989606,
            1.00000000, 0.90198230, 0.81465502,
            1.00000000, 0.90963069, 0.82838210,
            1.00000000, 0.91710889, 0.84190889,
            1.00000000, 0.92441842, 0.85523742,
            1.00000000, 0.93156127, 0.86836903,
            1.00000000, 0.93853986, 0.88130458,
            1.00000000, 0.94535695, 0.89404470,
            1.00000000, 0.95201559, 0.90658983,
            1.00000000, 0.95851906, 0.91894041,
            1.00000000, 0.96487079, 0.93109690,
            1.00000000, 0.97107439, 0.94305985,
            1.00000000, 0.97713351, 0.95482993,
            1.00000000, 0.98305189, 0.96640795,
            1.00000000, 0.98883326, 0.97779486,
            1.00000000, 0.99448139, 0.98899179,
            1.00000000, 1.00000000, 1.00000000, /* 6500K */
            0.98947904, 0.99348723, 1.00000000,
            0.97940448, 0.98722715, 1.00000000,
            0.96975025, 0.98120637, 1.00000000,
            0.96049223, 0.97541240, 1.00000000,
            0.95160805, 0.96983355, 1.00000000,
            0.94303638, 0.96443333, 1.00000000,
            0.93480451, 0.95923080, 1.00000000,
            0.92689056, 0.95421394, 1.00000000,
            0.91927697, 0.94937330, 1.00000000,
            0.91194747, 0.94470005, 1.00000000,
            0.90488690, 0.94018594, 1.00000000,
            0.89808115, 0.93582323, 1.00000000,
            0.89151710, 0.93160469, 1.00000000,
            0.88518247, 0.92752354, 1.00000000,
            0.87906581, 0.92357340, 1.00000000,
            0.87315640, 0.91974827, 1.00000000,
            0.86744421, 0.91604254, 1.00000000,
            0.86191983, 0.91245088, 1.00000000,
            0.85657444, 0.90896831, 1.00000000,
            0.85139976, 0.90559011, 1.00000000,
            0.84638799, 0.90231183, 1.00000000,
            0.84153180, 0.89912926, 1.00000000,
            0.83682430, 0.89603843, 1.00000000,
            0.83225897, 0.89303558, 1.00000000,
            0.82782969, 0.89011714, 1.00000000,
            0.82353066, 0.88727974, 1.00000000,
            0.81935641, 0.88452017, 1.00000000,
            0.81530175, 0.88183541, 1.00000000,
            0.81136180, 0.87922257, 1.00000000,
            0.80753191, 0.87667891, 1.00000000,
            0.80380769, 0.87420182, 1.00000000,
            0.80018497, 0.87178882, 1.00000000,
            0.79665980, 0.86943756, 1.00000000,
            0.79322843, 0.86714579, 1.00000000,
            0.78988728, 0.86491137, 1.00000000, /* 10000K */
            0.78663296, 0.86273225, 1.00000000,
            0.78346225, 0.86060650, 1.00000000,
            0.78037207, 0.85853224, 1.00000000,
            0.77735950, 0.85650771, 1.00000000,
            0.77442176, 0.85453121, 1.00000000,
            0.77155617, 0.85260112, 1.00000000,
            0.76876022, 0.85071588, 1.00000000,
            0.76603147, 0.84887402, 1.00000000,
            0.76336762, 0.84707411, 1.00000000,
            0.76076645, 0.84531479, 1.00000000,
            0.75822586, 0.84359476, 1.00000000,
            0.75574383, 0.84191277, 1.00000000,
            0.75331843, 0.84026762, 1.00000000,
            0.75094780, 0.83865816, 1.00000000,
            0.74863017, 0.83708329, 1.00000000,
            0.74636386, 0.83554194, 1.00000000,
            0.74414722, 0.83403311, 1.00000000,
            0.74197871, 0.83255582, 1.00000000,
            0.73985682, 0.83110912, 1.00000000,
            0.73778012, 0.82969211, 1.00000000,
            0.73574723, 0.82830393, 1.00000000,
            0.73375683, 0.82694373, 1.00000000,
            0.73180765, 0.82561071, 1.00000000,
            0.72989845, 0.82430410, 1.00000000,
            0.72802807, 0.82302316, 1.00000000,
            0.72619537, 0.82176715, 1.00000000,
            0.72439927, 0.82053539, 1.00000000,
            0.72263872, 0.81932722, 1.00000000,
            0.72091270, 0.81814197, 1.00000000,
            0.71922025, 0.81697905, 1.00000000,
            0.71756043, 0.81583783, 1.00000000,
            0.71593234, 0.81471775, 1.00000000,
            0.71433510, 0.81361825, 1.00000000,
            0.71276788, 0.81253878, 1.00000000,
            0.71122987, 0.81147883, 1.00000000,
            0.70972029, 0.81043789, 1.00000000,
            0.70823838, 0.80941546, 1.00000000,
            0.70678342, 0.80841109, 1.00000000,
            0.70535469, 0.80742432, 1.00000000,
            0.70395153, 0.80645469, 1.00000000,
            0.70257327, 0.80550180, 1.00000000,
            0.70121928, 0.80456522, 1.00000000,
            0.69988894, 0.80364455, 1.00000000,
            0.69858167, 0.80273941, 1.00000000,
            0.69729688, 0.80184943, 1.00000000,
            0.69603402, 0.80097423, 1.00000000,
            0.69479255, 0.80011347, 1.00000000,
            0.69357196, 0.79926681, 1.00000000,
            0.69237173, 0.79843391, 1.00000000,
            0.69119138, 0.79761446, 1.00000000, /* 15000K */
            0.69003044, 0.79680814, 1.00000000,
            0.68888844, 0.79601466, 1.00000000,
            0.68776494, 0.79523371, 1.00000000,
            0.68665951, 0.79446502, 1.00000000,
            0.68557173, 0.79370830, 1.00000000,
            0.68450119, 0.79296330, 1.00000000,
            0.68344751, 0.79222975, 1.00000000,
            0.68241029, 0.79150740, 1.00000000,
            0.68138918, 0.79079600, 1.00000000,
            0.68038380, 0.79009531, 1.00000000,
            0.67939381, 0.78940511, 1.00000000,
            0.67841888, 0.78872517, 1.00000000,
            0.67745866, 0.78805526, 1.00000000,
            0.67651284, 0.78739518, 1.00000000,
            0.67558112, 0.78674472, 1.00000000,
            0.67466317, 0.78610368, 1.00000000,
            0.67375872, 0.78547186, 1.00000000,
            0.67286748, 0.78484907, 1.00000000,
            0.67198916, 0.78423512, 1.00000000,
            0.67112350, 0.78362984, 1.00000000,
            0.67027024, 0.78303305, 1.00000000,
            0.66942911, 0.78244457, 1.00000000,
            0.66859988, 0.78186425, 1.00000000,
            0.66778228, 0.78129191, 1.00000000,
            0.66697610, 0.78072740, 1.00000000,
            0.66618110, 0.78017057, 1.00000000,
            0.66539706, 0.77962127, 1.00000000,
            0.66462376, 0.77907934, 1.00000000,
            0.66386098, 0.77854465, 1.00000000,
            0.66310852, 0.77801705, 1.00000000,
            0.66236618, 0.77749642, 1.00000000,
            0.66163375, 0.77698261, 1.00000000,
            0.66091106, 0.77647551, 1.00000000,
            0.66019791, 0.77597498, 1.00000000,
            0.65949412, 0.77548090, 1.00000000,
            0.65879952, 0.77499315, 1.00000000,
            0.65811392, 0.77451161, 1.00000000,
            0.65743716, 0.77403618, 1.00000000,
            0.65676908, 0.77356673, 1.00000000,
            0.65610952, 0.77310316, 1.00000000,
            0.65545831, 0.77264537, 1.00000000,
            0.65481530, 0.77219324, 1.00000000,
            0.65418036, 0.77174669, 1.00000000,
            0.65355332, 0.77130560, 1.00000000,
            0.65293404, 0.77086988, 1.00000000,
            0.65232240, 0.77043944, 1.00000000,
            0.65171824, 0.77001419, 1.00000000,
            0.65112144, 0.76959404, 1.00000000,
            0.65053187, 0.76917889, 1.00000000,
            0.64994941, 0.76876866, 1.00000000, /* 20000K */
            0.64937392, 0.76836326, 1.00000000,
            0.64880528, 0.76796263, 1.00000000,
            0.64824339, 0.76756666, 1.00000000,
            0.64768812, 0.76717529, 1.00000000,
            0.64713935, 0.76678844, 1.00000000,
            0.64659699, 0.76640603, 1.00000000,
            0.64606092, 0.76602798, 1.00000000,
            0.64553103, 0.76565424, 1.00000000,
            0.64500722, 0.76528472, 1.00000000,
            0.64448939, 0.76491935, 1.00000000,
            0.64397745, 0.76455808, 1.00000000,
            0.64347129, 0.76420082, 1.00000000,
            0.64297081, 0.76384753, 1.00000000,
            0.64247594, 0.76349813, 1.00000000,
            0.64198657, 0.76315256, 1.00000000,
            0.64150261, 0.76281076, 1.00000000,
            0.64102399, 0.76247267, 1.00000000,
            0.64055061, 0.76213824, 1.00000000,
            0.64008239, 0.76180740, 1.00000000,
            0.63961926, 0.76148010, 1.00000000,
            0.63916112, 0.76115628, 1.00000000,
            0.63870790, 0.76083590, 1.00000000,
            0.63825953, 0.76051890, 1.00000000,
            0.63781592, 0.76020522, 1.00000000,
            0.63737701, 0.75989482, 1.00000000,
            0.63694273, 0.75958764, 1.00000000,
            0.63651299, 0.75928365, 1.00000000,
            0.63608774, 0.75898278, 1.00000000,
            0.63566691, 0.75868499, 1.00000000,
            0.63525042, 0.75839025, 1.00000000,
            0.63483822, 0.75809849, 1.00000000,
            0.63443023, 0.75780969, 1.00000000,
            0.63402641, 0.75752379, 1.00000000,
            0.63362667, 0.75724075, 1.00000000,
            0.63323097, 0.75696053, 1.00000000,
            0.63283925, 0.75668310, 1.00000000,
            0.63245144, 0.75640840, 1.00000000,
            0.63206749, 0.75613641, 1.00000000,
            0.63168735, 0.75586707, 1.00000000,
            0.63131096, 0.75560036, 1.00000000,
            0.63093826, 0.75533624, 1.00000000,
            0.63056920, 0.75507467, 1.00000000,
            0.63020374, 0.75481562, 1.00000000,
            0.62984181, 0.75455904, 1.00000000,
            0.62948337, 0.75430491, 1.00000000,
            0.62912838, 0.75405319, 1.00000000,
            0.62877678, 0.75380385, 1.00000000,
            0.62842852, 0.75355685, 1.00000000,
            0.62808356, 0.75331217, 1.00000000,
            0.62774186, 0.75306977, 1.00000000, /* 25000K */
            0.62740336, 0.75282962, 1.00000000  /* 25100K */
    };

    private final static int[] GAMMA = {0, 64, 128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 896, 
    960, 1024, 1089, 1153, 1217, 1281, 1345, 1409, 1473, 1537, 1601, 1665, 1729, 1793, 1857, 1921, 1985, 2049, 2114, 
    2178, 2242, 2306, 2370, 2434, 2498, 2562, 2626, 2690, 2754, 2818, 2882, 2946, 3010, 3074, 3139, 3203, 3267, 3331,
    3395, 3459, 3523, 3587, 3651, 3715, 3779, 3843, 3907, 3971, 4035, 4099, 4164, 4228, 4292, 4356, 4420, 4484, 4548,
    4612, 4676, 4740, 4804, 4868, 4932, 4996, 5060, 5124, 5188, 5253, 5317, 5381, 5445, 5509, 5573, 5637, 5701, 5765,
    5829, 5893, 5957, 6021, 6085, 6149, 6213, 6278, 6342, 6406, 6470, 6534, 6598, 6662, 6726, 6790, 6854, 6918, 6982,
    7046, 7110, 7174, 7238, 7303, 7367, 7431, 7495, 7559, 7623, 7687, 7751, 7815, 7879, 7943, 8007, 8071, 8135, 8199,
    8263, 8328, 8392, 8456, 8520, 8584, 8648, 8712, 8776, 8840, 8904, 8968, 9032, 9096, 9160, 9224, 9288, 9352, 9417,
    9481, 9545, 9609, 9673, 9737, 9801, 9865, 9929, 9993, 10057, 10121, 10185, 10249, 10313, 10377, 10442, 10506, 10570, 
    10634, 10698, 10762, 10826, 10890, 10954, 11018, 11082, 11146, 11210, 11274, 11338, 11402, 11467, 11531, 11595, 11659,
    11723, 11787, 11851, 11915, 11979, 12043, 12107, 12171, 12235, 12299, 12363, 12427, 12492, 12556, 12620, 12684, 12748, 
    12812, 12876, 12940, 13004, 13068, 13132, 13196, 13260, 13324, 13388, 13452, 13516, 13581, 13645, 13709, 13773, 13837, 
    13901, 13965, 14029, 14093, 14157, 14221, 14285, 14349, 14413, 14477, 14541, 14606, 14670, 14734, 14798, 14862, 14926,
    14990, 15054, 15118, 15182, 15246, 15310, 15374, 15438, 15502, 15566, 15631, 15695, 15759, 15823, 15887, 15951, 16015, 
    16079, 16143, 16207, 16271, 16335, 16399, 16463, 16527, 16591, 16656, 16720, 16784, 16848, 16912, 16976, 17040, 17104, 
    17168, 17232, 17296, 17360, 17424, 17488, 17552, 17616, 17680, 17745, 17809, 17873, 17937, 18001, 18065, 18129, 18193, 
    18257, 18321, 18385, 18449, 18513, 18577, 18641, 18705, 18770, 18834, 18898, 18962, 19026, 19090, 19154, 19218, 19282, 
    19346, 19410, 19474, 19538, 19602, 19666, 19730, 19795, 19859, 19923, 19987, 20051, 20115, 20179, 20243, 20307, 20371, 
    20435, 20499, 20563, 20627, 20691, 20755, 20820, 20884, 20948, 21012, 21076, 21140, 21204, 21268, 21332, 21396, 21460,
    21524, 21588, 21652, 21716, 21780, 21845, 21909, 21973, 22037, 22101, 22165, 22229, 22293, 22357, 22421, 22485, 22549, 
    22613, 22677, 22741, 22805, 22869, 22934, 22998, 23062, 23126, 23190, 23254, 23318, 23382, 23446, 23510, 23574, 23638,
    23702, 23766, 23830, 23894, 23959, 24023, 24087, 24151, 24215, 24279, 24343, 24407, 24471, 24535, 24599, 24663, 24727, 
    24791, 24855, 24919, 24984, 25048, 25112, 25176, 25240, 25304, 25368, 25432, 25496, 25560, 25624, 25688, 25752, 25816,
    25880, 25944, 26009, 26073, 26137, 26201, 26265, 26329, 26393, 26457, 26521, 26585, 26649, 26713, 26777, 26841, 26905, 
    26969, 27033, 27098, 27162, 27226, 27290, 27354, 27418, 27482, 27546, 27610, 27674, 27738, 27802, 27866, 27930, 27994, 
    28058, 28123, 28187, 28251, 28315, 28379, 28443, 28507, 28571, 28635, 28699, 28763, 28827, 28891, 28955, 29019, 29083, 
    29148, 29212, 29276, 29340, 29404, 29468, 29532, 29596, 29660, 29724, 29788, 29852, 29916, 29980, 30044, 30108, 30173, 
    30237, 30301, 30365, 30429, 30493, 30557, 30621, 30685, 30749, 30813, 30877, 30941, 31005, 31069, 31133, 31197, 31262, 
    31326, 31390, 31454, 31518, 31582, 31646, 31710, 31774, 31838, 31902, 31966, 32030, 32094, 32158, 32222, 32287, 32351,
    32415, 32479, 32543, 32607, 32671, 32735, 32799, 32863, 32927, 32991, 33055, 33119, 33183, 33247, 33312, 33376, 33440,
    33504, 33568, 33632, 33696, 33760, 33824, 33888, 33952, 34016, 34080, 34144, 34208, 34272, 34337, 34401, 34465, 34529,
    34593, 34657, 34721, 34785, 34849, 34913, 34977, 35041, 35105, 35169, 35233, 35297, 35361, 35426, 35490, 35554, 35618,
    35682, 35746, 35810, 35874, 35938, 36002, 36066, 36130, 36194, 36258, 36322, 36386, 36451, 36515, 36579, 36643, 36707, 
    36771, 36835, 36899, 36963, 37027, 37091, 37155, 37219, 37283, 37347, 37411, 37476, 37540, 37604, 37668, 37732, 37796, 
    37860, 37924, 37988, 38052, 38116, 38180, 38244, 38308, 38372, 38436, 38501, 38565, 38629, 38693, 38757, 38821, 38885, 
    38949, 39013, 39077, 39141, 39205, 39269, 39333, 39397, 39461, 39525, 39590, 39654, 39718, 39782, 39846, 39910, 39974, 
    40038, 40102, 40166, 40230, 40294, 40358, 40422, 40486, 40550, 40615, 40679, 40743, 40807, 40871, 40935, 40999, 41063, 
    41127, 41191, 41255, 41319, 41383, 41447, 41511, 41575, 41640, 41704, 41768, 41832, 41896, 41960, 42024, 42088, 42152, 
    42216, 42280, 42344, 42408, 42472, 42536, 42600, 42665, 42729, 42793, 42857, 42921, 42985, 43049, 43113, 43177, 43241, 
    43305, 43369, 43433, 43497, 43561, 43625, 43690, 43754, 43818, 43882, 43946, 44010, 44074, 44138, 44202, 44266, 44330, 
    44394, 44458, 44522, 44586, 44650, 44714, 44779, 44843, 44907, 44971, 45035, 45099, 45163, 45227, 45291, 45355, 45419, 
    45483, 45547, 45611, 45675, 45739, 45804, 45868, 45932, 45996, 46060, 46124, 46188, 46252, 46316, 46380, 46444, 46508,
    46572, 46636, 46700, 46764, 46829, 46893, 46957, 47021, 47085, 47149, 47213, 47277, 47341, 47405, 47469, 47533, 47597,
    47661, 47725, 47789, 47854, 47918, 47982, 48046, 48110, 48174, 48238, 48302, 48366, 48430, 48494, 48558, 48622, 48686,
    48750, 48814, 48878, 48943, 49007, 49071, 49135, 49199, 49263, 49327, 49391, 49455, 49519, 49583, 49647, 49711, 49775,
    49839, 49903, 49968, 50032, 50096, 50160, 50224, 50288, 50352, 50416, 50480, 50544, 50608, 50672, 50736, 50800, 50864, 
    50928, 50993, 51057, 51121, 51185, 51249, 51313, 51377, 51441, 51505, 51569, 51633, 51697, 51761, 51825, 51889, 51953, 
    52018, 52082, 52146, 52210, 52274, 52338, 52402, 52466, 52530, 52594, 52658, 52722, 52786, 52850, 52914, 52978, 53042, 
    53107, 53171, 53235, 53299, 53363, 53427, 53491, 53555, 53619, 53683, 53747, 53811, 53875, 53939, 54003, 54067, 54132, 
    54196, 54260, 54324, 54388, 54452, 54516, 54580, 54644, 54708, 54772, 54836, 54900, 54964, 55028, 55092, 55157, 55221, 
    55285, 55349, 55413, 55477, 55541, 55605, 55669, 55733, 55797, 55861, 55925, 55989, 56053, 56117, 56182, 56246, 56310, 
    56374, 56438, 56502, 56566, 56630, 56694, 56758, 56822, 56886, 56950, 57014, 57078, 57142, 57206, 57271, 57335, 57399,
    57463, 57527, 57591, 57655, 57719, 57783, 57847, 57911, 57975, 58039, 58103, 58167, 58231, 58296, 58360, 58424, 58488,
    58552, 58616, 58680, 58744, 58808, 58872, 58936, 59000, 59064, 59128, 59192, 59256, 59321, 59385, 59449, 59513, 59577, 
    59641, 59705, 59769, 59833, 59897, 59961, 60025, 60089, 60153, 60217, 60281, 60346, 60410, 60474, 60538, 60602, 60666, 
    60730, 60794, 60858, 60922, 60986, 61050, 61114, 61178, 61242, 61306, 61370, 61435, 61499, 61563, 61627, 61691, 61755, 
    61819, 61883, 61947, 62011, 62075, 62139, 62203, 62267, 62331, 62395, 62460, 62524, 62588, 62652, 62716, 62780, 62844,
    62908, 62972, 63036, 63100, 63164, 63228, 63292, 63356, 63420, 63485, 63549, 63613, 63677, 63741, 63805, 63869, 63933,
    63997, 64061, 64125, 64189, 64253, 64317, 64381, 64445, 64510, 64574, 64638, 64702, 64766, 64830, 64894, 64958, 65022, 
    65086, 65150, 65214, 65278, 65342, 65406, 65470, 65535};

    private static double[] white_point = new double[3];

    private static double F(double Y, int C) {
        return (Math.pow(Y * white_point[C], 1.0 / 1));
    }

    public static int[][] colorTemperatureToRGB(int lutsize, int tmp) {
        int[][] ret = new int[3][lutsize];
        int[] red = new int[lutsize];
        int[] green = new int[lutsize];
        int[] blue = new int[lutsize];

        double alpha = (tmp % 100 / 100.0);
        int temp_index = ((tmp - 1000) / 100) * 3;
        white_point[0] = ((1.0 - alpha) * blackbody_color[temp_index] + alpha * blackbody_color[temp_index + 3]);
        white_point[1] = ((1.0 - alpha) * blackbody_color[temp_index + 1] + alpha * blackbody_color[temp_index + 4]);
        white_point[2] = ((1.0 - alpha) * blackbody_color[temp_index + 2] + alpha * blackbody_color[temp_index + 5]);

        for (int i = 0; i < lutsize; i++) {
            double temp = i * 65535 / (lutsize - 1);
            red[i] = (int) (F((double) (temp / 65536.0), 0) * 65536);
            green[i] = (int) (F((double) (temp / (65536.0)), 1) * 65536);
            blue[i] = (int) (F((double) (temp / (65536.0)), 2) * 65536);
        }
        ret[0] = red;
        ret[1] = green;
        ret[2] = blue;
        return ret;
    }

    private static int max (int a, int b) {
        return a > b ? a : b;
    }

    private static int min (int a, int b) {
        return a < b ? a : b;
    }

    private static int clip (int x, int min_v, int max_v) {
        return min(max(x, min_v), max_v);
    }

    public static int[][] gammaColorTempAdjust(int rgain, int ggain, int bgain) {
        int max_vl = 65535;
        int gain_bit = 8;
        int[][] ret = new int[3][1024];
        int[] red = new int[1024];
        int[] green = new int[1024];
        int[] blue = new int[1024];

        for (int i = 0; i < 1024; i++)
        {
            red[i] = clip((GAMMA[i] * rgain + (1 << (gain_bit - 1))) >> (gain_bit), 0, max_vl);
            green[i] = clip((GAMMA[i] * ggain + (1 << (gain_bit - 1))) >> (gain_bit), 0, max_vl);
            blue[i] = clip((GAMMA[i] * bgain + (1 << (gain_bit - 1))) >> (gain_bit), 0, max_vl);
        }
        ret[0] = red;
        ret[1] = green;
        ret[2] = blue;
        return ret;
    }
}
